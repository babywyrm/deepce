<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!-- This file was created with the aha Ansi HTML Adapter. https://github.com/theZiz/aha -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="application/xml+xhtml; charset=UTF-8" />
<title>results/docker-ubuntu-exploit-sys-module.log</title>
</head>
<body style="color:white; background-color:black">
<pre>

<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">                      ##</span><span style="font-weight:bold;color:white;">         .
</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">                ## ## ##</span><span style="font-weight:bold;color:white;">        ==
</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">             ## ## ## ##</span><span style="font-weight:bold;color:white;">       ===
         /&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;&quot;\___/ ===
</span><span style="font-weight:bold;color:#3333FF;">    ~~~ </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">{</span><span style="font-weight:bold;color:#3333FF;">~~ ~~~~ ~~~ ~~~~ ~~~ ~</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"> /  </span><span style="font-weight:bold;color:white;">===-</span><span style="font-weight:bold;color:#3333FF;"> ~~~</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">         \______ X           __/
           \    \         __/
            \____\_______/</span>
          __
     ____/ /__  ___  ____  ________
    / __  / _ \/ _ \/ __ \/ ___/ _ \ <span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">  ENUMERATE</span>
   / /_/ /  __/  __/ /_/ / (__/  __/ <span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"> ESCALATE</span>
   \__,_/\___/\___/ .___/\___/\___/<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">  ESCAPE</span>
                 /_/

 Docker Enumeration, Escalation of Privileges and Container Escapes (DEEPCE)
 by stealthcopter

<span style="font-weight:bold;color:#3333FF;">==========================================</span><span style="font-weight:bold;color:lime;">( Colors )</span><span style="font-weight:bold;color:#3333FF;">==========================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Exploit Test ............ </span><span style="background-color:red;">Exploitable - Check this out</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Basic Test .............. </span><span style="font-weight:bold;color:yellow;">Positive Result</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Another Test ............ </span><span style="font-weight:bold;color:red;">Error running check</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Negative Test ........... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Multi line test ......... </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Command output
spanning multiple lines</span>

<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Tips will look like this and often contains links with additional info. You can usually 
ctrl+click links in modern terminal to open in a browser window
See </span><span style="text-decoration:underline;font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">https://stealthcopter.github.io/deepce</span>

<span style="font-weight:bold;color:#3333FF;">===================================</span><span style="font-weight:bold;color:lime;">( Installing Packages )</span><span style="font-weight:bold;color:#3333FF;">====================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Installing Packages ..... </span><span style="font-weight:bold;color:yellow;">Success</span>
<span style="font-weight:bold;color:#3333FF;">===================================</span><span style="font-weight:bold;color:lime;">( Enumerating Platform )</span><span style="font-weight:bold;color:#3333FF;">===================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Inside Container ........ </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container Platform ...... </span><span style="font-weight:bold;color:yellow;">docker</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container tools ......... </span><span style="font-weight:bold;color:red;">None</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> User .................... </span><span style="font-weight:bold;color:yellow;">root</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Groups .................. </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"></span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">root</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;"></span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker Executable ....... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Not Found</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker Sock ............. </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Not Found</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker Version .......... </span><span style="font-weight:bold;color:red;">Version Unknown</span>
<span style="font-weight:bold;color:#3333FF;">==================================</span><span style="font-weight:bold;color:lime;">( Enumerating Container )</span><span style="font-weight:bold;color:#3333FF;">===================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container ID ............ </span><span style="font-weight:bold;color:yellow;">f70969b09467</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container Full ID ....... </span><span style="font-weight:bold;color:yellow;">f70969b09467dcde723a2dddf21e449de59796bdac2e250c6da5f5807fc9c675</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container Name .......... </span><span style="font-weight:bold;color:red;">Could not get container name through reverse DNS</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Container IP ............ </span><span style="font-weight:bold;color:yellow;">172.17.0.2 </span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> DNS Server(s) ........... </span><span style="font-weight:bold;color:yellow;">168.63.129.16 </span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Host IP ................. </span><span style="font-weight:bold;color:yellow;">172.17.0.1</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Operating System ........ </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">GNU/Linux</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Kernel .................. </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">5.4.0-1046-azure</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Arch .................... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">x86_64</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> CPU ..................... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Intel(R) Xeon(R) CPU E5-2673 v3 @ 2.40GHz</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Useful tools installed .. </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">/usr/bin/curl
/usr/bin/nslookup
/usr/bin/host
/usr/bin/hostname
/usr/bin/dig
/usr/bin/nmap</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Dangerous Capabilities .. </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Bounding set =cap_chown,</span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">cap_dac_override</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">,</span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">cap_dac_read_search</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,</span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">cap_sys_module</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">,cap_sys_rawio,cap_sys_chroot,</span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">cap_sys_ptrace</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">,cap_sys_pacct,</span><span style="font-weight:bold;color:white;"></span><span style="font-weight:bold;color:white;background-color:red;">cap_sys_admin</span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> SSHD Service ............ </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Privileged Mode ......... </span><span style="background-color:red;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">The container appears to be running in privilege mode, we should be able to access the 
raw disks and mount the hosts root partition in order to gain code execution.
See </span><span style="text-decoration:underline;font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">https://stealthcopter.github.io/deepce/guides/docker-privileged.md</span>

<span style="font-weight:bold;color:#3333FF;">====================================</span><span style="font-weight:bold;color:lime;">( Enumerating Mounts )</span><span style="font-weight:bold;color:#3333FF;">====================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Docker sock mounted ....... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Other mounts .............. </span><span style="font-weight:bold;color:yellow;">Yes</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">/home/runner/work/deepce/deepce/deepce.sh /root/deepce.sh rw,relatime - ext4 /dev/root rw,discard
/usr/lib/modules /usr/lib/modules rw,relatime - ext4 /dev/root rw,discard
/usr/src /usr/src rw,relatime - ext4 /dev/root rw,discard</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Possible host usernames ... </span><span style="font-weight:bold;color:yellow;"> runner </span>
<span style="font-weight:bold;color:#3333FF;">====================================</span><span style="font-weight:bold;color:lime;">( Interesting Files )</span><span style="font-weight:bold;color:#3333FF;">=====================================</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Interesting environment variables ... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Any common entrypoint files ......... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Interesting files in root ........... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Passwords in common files ........... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Home directories .................... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Hashes in shadow file ............... </span><span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">No permissions</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Searching for app dirs .............. </span>
<span style="font-weight:bold;color:#3333FF;">==================================</span><span style="font-weight:bold;color:lime;">( Enumerating Containers )</span><span style="font-weight:bold;color:#3333FF;">==================================</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">By default containers can communicate with other containers on the same network and the 
host machine, this can be used to enumerate further</span>

<span style="font-weight:bold;color:#3333FF;">==================================</span><span style="font-weight:bold;color:lime;">( Exploiting SYS_MODULE )</span><span style="font-weight:bold;color:#3333FF;">===================================</span>
<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Giving the container the SYS_MODULE privilege allows for kernel modules to be mounted. 
Using this, a malicious module can be used to execute code as root on the host.</span>

<span style="font-weight:bold;filter: contrast(70%) brightness(190%);color:dimgray;">Installing requirements</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Writing files  ............ </span><span style="font-weight:bold;color:yellow;">Done</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Compiling kernel module ... </span><span style="font-weight:bold;color:yellow;">Done</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Mounting kernel module .... </span><span style="font-weight:bold;color:yellow;">Done</span>
<span style="font-weight:bold;color:yellow;">[+]</span><span style="font-weight:bold;color:lime;"> Cleaning up ............... </span><span style="font-weight:bold;color:yellow;">Done</span>
<span style="font-weight:bold;color:yellow;">Check your reverse shell handler!</span>
<span style="font-weight:bold;color:#3333FF;">===============================================</span><span style="font-weight:bold;color:lime;"></span><span style="font-weight:bold;color:#3333FF;">===============================================</span>
</pre>
</body>
</html>
