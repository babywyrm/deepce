
[1;90m                      ##[1;37m         .
[1;90m                ## ## ##[1;37m        ==
[1;90m             ## ## ## ##[1;37m       ===
[1;37m         /"""""""""""""""""\___/ ===
[1;34m    ~~~ [1;90m{[1;34m~~ ~~~~ ~~~ ~~~~ ~~~ ~[1;90m /  [1;37m===-[1;34m ~~~[0m
[1;90m         \______ X           __/
[1;90m           \    \         __/
[1;90m            \____\_______/[0m
          __
     ____/ /__  ___  ____  ________
    / __  / _ \/ _ \/ __ \/ ___/ _ \ [1;90m  ENUMERATE[0m
   / /_/ /  __/  __/ /_/ / (__/  __/ [1;90m ESCALATE[0m
   \__,_/\___/\___/ .___/\___/\___/[1;90m  ESCAPE[0m
                 /_/

 Docker Enumeration, Escalation of Privileges and Container Escapes (DEEPCE)
 by stealthcopter

[1;34m==========================================[1;32m( Colors )[1;34m==========================================[0m
[1;33m[+][1;32m Exploit Test ............ [0m[48;5;1mExploitable - Check this out[0m
[1;33m[+][1;32m Basic Test .............. [0m[1;33mPositive Result[0m
[1;33m[+][1;32m Another Test ............ [0m[1;31mError running check[0m
[1;33m[+][1;32m Negative Test ........... [0m[1;90mNo[0m
[1;33m[+][1;32m Multi line test ......... [0m[1;33mYes[0m
[1;90mCommand output
spanning multiple lines[0m

[1;90mTips will look like this and often contains links with additional info. You can usually 
ctrl+click links in modern terminal to open in a browser window
See [4mhttps://stealthcopter.github.io/deepce[0m[0m

[1;34m===================================[1;32m( Installing Packages )[1;34m====================================[0m
[1;33m[+][1;32m Installing Packages ..... [0m[1;33mSuccess[0m
[1;34m===================================[1;32m( Enumerating Platform )[1;34m===================================[0m
[1;33m[+][1;32m Inside Container ........ [0m[1;33mYes[0m
[1;33m[+][1;32m Container Platform ...... [0m[1;33mdocker[0m
[1;33m[+][1;32m Container tools ......... [0m[1;31mNone[0m
[1;33m[+][1;32m User .................... [0m[1;33mroot[0m
[1;33m[+][1;32m Groups .................. [0m[1;90m[1;37m[48;5;1mroot[0m[1;90m[0m
[1;33m[+][1;32m Docker Executable ....... [0m[1;90mNot Found[0m
[1;33m[+][1;32m Docker Sock ............. [0m[1;90mNot Found[0m
[1;33m[+][1;32m Docker Version .......... [0m[1;31mVersion Unknown[0m
[1;34m==================================[1;32m( Enumerating Container )[1;34m===================================[0m
[1;33m[+][1;32m Container ID ............ [0m[1;33mc11f611e0640[0m
[1;33m[+][1;32m Container Full ID ....... [0m[1;33mc11f611e064093722f6c2c1227baf77729d114a2bdf8f946dbe2956f3b83aaf7[0m
[1;33m[+][1;32m Container Name .......... [0m[1;31mCould not get container name through reverse DNS[0m
[1;33m[+][1;32m Container IP ............ [0m[1;33m172.17.0.2 [0m
[1;33m[+][1;32m DNS Server(s) ........... [0m[1;33m168.63.129.16 [0m
[1;33m[+][1;32m Host IP ................. [0m[1;33m172.17.0.1[0m
[1;33m[+][1;32m Operating System ........ [0m[1;90mGNU/Linux[0m
[1;33m[+][1;32m Kernel .................. [0m[1;90m5.4.0-1046-azure[0m
[1;33m[+][1;32m Arch .................... [0m[1;90mx86_64[0m
[1;33m[+][1;32m CPU ..................... [0m[1;90mIntel(R) Xeon(R) CPU E5-2673 v4 @ 2.30GHz[0m
[1;33m[+][1;32m Useful tools installed .. [0m[1;33mYes[0m
[1;90m/usr/bin/curl
/usr/bin/nslookup
/usr/bin/host
/usr/bin/hostname
/usr/bin/dig
/usr/bin/nmap[0m
[1;33m[+][1;32m Dangerous Capabilities .. [0m[1;33mYes[0m
[1;90mBounding set =cap_chown,[1;37m[48;5;1mcap_dac_override[0m[1;90m,[1;37m[48;5;1mcap_dac_read_search[0m[1;90m,cap_fowner,cap_fsetid,cap_kill,cap_setgid,cap_setuid,cap_setpcap,cap_linux_immutable,cap_net_bind_service,cap_net_broadcast,cap_net_admin,cap_net_raw,cap_ipc_lock,cap_ipc_owner,[1;37m[48;5;1mcap_sys_module[0m[1;90m,cap_sys_rawio,cap_sys_chroot,[1;37m[48;5;1mcap_sys_ptrace[0m[1;90m,cap_sys_pacct,[1;37m[48;5;1mcap_sys_admin[0m[1;90m,cap_sys_boot,cap_sys_nice,cap_sys_resource,cap_sys_time,cap_sys_tty_config,cap_mknod,cap_lease,cap_audit_write,cap_audit_control,cap_setfcap,cap_mac_override,cap_mac_admin,cap_syslog,cap_wake_alarm,cap_block_suspend,cap_audit_read[0m
[1;33m[+][1;32m SSHD Service ............ [0m[1;90mNo[0m
[1;33m[+][1;32m Privileged Mode ......... [0m[48;5;1mYes[0m
[1;90mThe container appears to be running in privilege mode, we should be able to access the 
raw disks and mount the hosts root partition in order to gain code execution.
See [4mhttps://stealthcopter.github.io/deepce/guides/docker-privileged.md[0m[0m

[1;34m====================================[1;32m( Enumerating Mounts )[1;34m====================================[0m
[1;33m[+][1;32m Docker sock mounted ....... [0m[1;90mNo[0m
[1;33m[+][1;32m Other mounts .............. [0m[1;33mYes[0m
[1;90m/home/runner/work/deepce/deepce/deepce.sh /root/deepce.sh rw,relatime - ext4 /dev/root rw,discard
/usr/lib/modules /usr/lib/modules rw,relatime - ext4 /dev/root rw,discard
/usr/src /usr/src rw,relatime - ext4 /dev/root rw,discard[0m
[1;33m[+][1;32m Possible host usernames ... [0m[1;33m runner [0m
[1;34m====================================[1;32m( Interesting Files )[1;34m=====================================[0m
[1;33m[+][1;32m Interesting environment variables ... [0m[1;90mNo[0m
[1;33m[+][1;32m Any common entrypoint files ......... [0m[1;90mNo[0m
[1;33m[+][1;32m Interesting files in root ........... [0m[1;90mNo[0m
[1;33m[+][1;32m Passwords in common files ........... [0m[1;90mNo[0m
[1;33m[+][1;32m Home directories .................... [0m[1;90mNo[0m
[1;33m[+][1;32m Hashes in shadow file ............... [0m[1;90mNo permissions[0m
[1;33m[+][1;32m Searching for app dirs .............. [0m
[1;34m==================================[1;32m( Enumerating Containers )[1;34m==================================[0m
[1;90mBy default containers can communicate with other containers on the same network and the 
host machine, this can be used to enumerate further[0m

[1;34m==================================[1;32m( Exploiting SYS_MODULE )[1;34m===================================[0m
[1;90mGiving the container the SYS_MODULE privilege allows for kernel modules to be mounted. 
Using this, a malicious module can be used to execute code as root on the host.[0m

[1;90mInstalling requirements[0m
[1;33m[+][1;32m Writing files  ............ [0m[1;33mDone[0m
[1;33m[+][1;32m Compiling kernel module ... [0m[1;33mDone[0m
[1;33m[+][1;32m Mounting kernel module .... [0m[1;33mDone[0m
[1;33m[+][1;32m Cleaning up ............... [0m[1;33mDone[0m
[1;33mCheck your reverse shell handler![0m
[1;34m===============================================[1;32m[1;34m===============================================[0m
